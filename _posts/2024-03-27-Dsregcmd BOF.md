---
layout: post
title: Dsregcmd Bof
categories: [Ideas, bofs]
tags:
  - ideas
  - bofs
permalink: /:categories/:year/:month/:day/:title
---


## Update

This is actually doable. Just call the function exported by `dsregcli.dll!DsrCLI`
[X's Thread](https://x.com/mhskai2017/status/1773532112362045680)

## Dsregcmd /status

```
+----------------------------------------------------------------------+
| Device State                                                         |
+----------------------------------------------------------------------+


+----------------------------------------------------------------------+
| Device Details                                                       |
+----------------------------------------------------------------------+


+----------------------------------------------------------------------+
| Tenant Details                                                       |
+----------------------------------------------------------------------+

              

+----------------------------------------------------------------------+
| User State                                                           |
+----------------------------------------------------------------------+

          
+----------------------------------------------------------------------+
| SSO State                                                            |
+----------------------------------------------------------------------+

           

+----------------------------------------------------------------------+
| Work Account 1                                                       |
+----------------------------------------------------------------------+

  

+----------------------------------------------------------------------+
| Diagnostic Data                                                      |
+----------------------------------------------------------------------+

    
+----------------------------------------------------------------------+
| IE Proxy Config for Current User                                     |
+----------------------------------------------------------------------+

+----------------------------------------------------------------------+
| WinHttp Default Proxy Config                                         |
+----------------------------------------------------------------------+

             

+----------------------------------------------------------------------+
| Ngc Prerequisite Check                                               |
+----------------------------------------------------------------------+
```

It'd be useful if I can write some BOF that will display this information or a .NET assembly.
